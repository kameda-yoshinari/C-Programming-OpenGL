<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-2022-JP">
<title>1. プログラミング基礎復習 -- "Hello ESYS" 再び --</title>
</head>

<body bgcolor="#a0d8a2">

<font color="#802020"><h2>1. プログラミング基礎復習 -- "Hello ESYS" 再び --</h2></font>
【プログラミング序論Ｄ】

<a href="./index-j.html#material">目次</a>, 
<font size="1">2024/01/18a</font>

<hr><!-- +++++++++++++++++++++++++++++++++++ -->

<p >本実習の目的は、C言語に慣れてもらうことです．
<br>これまでの授業で最小限のC言語プログラミングはできるようになってきていると思います．

<p >ところで、外国語を勉強するとき、必要なのは才能ではなく練習です．
<br><font size="-1" color="gray">（ヘミングウェイを目指すなら英語の勉強に加えて才能も必要でしょう．しかし、英語で普通に文章を書けることを目指すだけなら才能など大して要りません．）</font>
<br>日本で生まれていれば、才能の有無に関係なく、誰でも日本語を話せるようになるでしょう．
<br><font size="-1" color="gray">（みなさんが米国で生まれ育っていれば、必ず英語を話せたことでしょう．話すようになるだけなら，時間をかけて練習すればなんとかなるのです．）</font>
<br>C言語も『言語』です．時間さえかけて練習すれば必ず<s>話せる</s>書けるようになります．
<br><font size="-1" color="gray">（もちろんどの言語でも、個人差はあります．同じ年数生きてきていても日本語に上手下手は個人差があるでしょう．それでも喋れない人はいません．）</font>
<br><font size="-1" color="gray">（Native C speakerなんて人間はちょっと怖いですがそれぐらいを目指すということで．）</font>

<p >ところで、外国語を勉強するとき、必要なのはきちんとした外国語を話せて文章を書ける先生につくことです．
<br><font size="-1" color="gray">（ブロークンな英語を喋る知り合いや、文法もよくわかってない友達から英語を習ったら、怪しげな英語を使う人になってしまいます）</font>

<p >C言語もまた「言語」です．
<br>言語である以上、文法があるだけではなく、作法や慣習があります．

<p >日本語でも、ただ友達と会話する程度なら、誰かに習わなくても友達とつきあっていれば自然に身につきます．
<br>しかし，誰と話しても誤解を招かないようなきちんとした日本語を話すためにはそれなりに訓練が必要です．
<br>NHKのアナウンサーが話す日本語と、みなさんが友達と会話しているときの日本語は、同じ日本語でもレベルが違います．

<p >同じことはC言語でも当てはまります．
<br>みなさんはプログラマになる立場（日本語で言えばアナウンサーや新聞記者に相当する立場）ですから、単に書けるだけではなく、正しく簡潔なプログラムを書くことを目標にしましょう．


<!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
<a name="sec.01.01."></a><hr>
<font color="#802020"><h3>01.01. ぞんざいなHello ESYS</h3></font>

<p >まずはC言語プログラミングの復習をしましょう．
<br>

<p >今まで受けてきた授業の復習がてら、ウォーミングアップです．
<br>以下のサンプルは「悪い例」です．こんな書き方をしてきた人は，これから心を入れ替えて下さい．
<br><font size="-1" color="gray">（間違っているわけではないのですが、誤解を招きかねない書き方です）</font>

<p ><a href="code/01-01/01-01-HelloESYS-NotSoGood.c">01-01-HelloESYS-NotSoGood.c</a>

<p >何が悪いのでしょうか？
<br>次のプログラムを見る前に、４つは指摘できるといいですね．

<p >ダウンロードして、このままでコンパイルしてください．
<br>gccがコンパイルコマンドですね。単一ソースファイルの場合、特に指定しなければ実行ファイルは a.out という名前で生成されます．
<br>実行ファイルを実行するときは、先頭に ./ (ドット スラッシュ）をつけてください．
<br><font size="-1" color="gray">（2021年度からこのような手順を習ってきていないという事態になってしまいました）</font>
<br>lsはディレクトリ内のファイル一覧を表示するbashのビルトインコマンドです．
<br><font size="-1" color="gray">（ls -l にすると，long listing オプションが入ってファイルの説明が詳しくなります）</font>
<br>fileコマンドはファイルタイプを判定するunixの（linuxの）プログラムです．
<br><font size="-1" color="gray">（詳しくは $ man file）</font>

<p >
<table border=1><tr>
<br>$ gcc 01-01-HelloESYS-NotSoGood.c
<br>$ ls
<br>$ ls -l
<br>$ file 01-01-HelloESYS-NotSoGood.c
<br>$ file a.out
<br>$ ./out
</table>

<br>プログラムを自分なりに修正してください．それをコンパイルし直してください．
<br>修正はgeditというプログラムが分かりやすいと思います．(emacsでも可）

<p >
<table border=1><tr>
<td>$ gedit 01-01-HelloESYS-NotSoGood.c
</table>    


<p ><u><b>演習</b></u>

<p ><b>01-01-ex1</b>: ５階計算機システム Ubuntu linux（本授業）において、「ターミナル」とは何を指しますか？

<p ><b>01-01-ex2</b>: このターミナルのようなインタフェースをアルファベット３文字で何と言いますか？その正式名称は何でしょうか？

<p ><b>01-01-ex3</b>: なぜこのテキストばかりのウィンドウを「ターミナル（日本語では端末）」と呼ぶのでしょうか？

<p ><b>01-01-ex4</b>: 似た表現にコンソールという用語があります．なぜコンソールというのか，英語の語源も調べて考えてみなさい．

<!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
<a name="sec.01.02."></a><hr width="30%" align="left">
<font color="#802020"><h3>01.02 上品なHello ESYS</h3></font>

<p >先のプログラムの書き方は何が悪かったのでしょうか？
<br>次の改善されたプログラムを見てみましょう．

<p ><a href="code/01-02/01-02-HelloESYS-Better.c">01-02-HelloESYS-Better.c</a>
<br><a href="code/01-02/01-01_01-02.html">01-01からの差分</a>
<br><font size="-1" color="gray">（2024年現在，上記の「差分」のページは古くなってきているので，インターネットのテキスト比較(diff)サイトなどを利用したほうがいいでしょう．例えば<a href="https://www.diffchecker.com/">https://www.diffchecker.com/</a>など．この先も同様です）</font>

<p >元のプログラムの悪かったところがわかりましたか？
<br><font color="#a0d8a2">(1)"#include &lt;stdio.h&gt;"がない</font>
<br><font color="#a0d8a2">(2)main()関数にint型を指定していない</font>
<br><font color="#a0d8a2">(3)main()関数の引数を記述していない</font>
<br><font color="#a0d8a2">(4)プログラム終了時にmain()関数の返値(int型)を与えていない</font>
<br><font size="-1" color="gray">（↑反転させれば正解が‥）</font>

<p ><b>コンパイル方法</b>

<p >まず、コマンドラインでのコンパイル方法と実行について、今後は

<p >
<table border=1><tr>
<td>$ gcc -Wall -o <u>ターゲット実行ファイル名</u> <u>ソースCファイル</u>
<br>$ gcc -Wall -o 01-02-HelloESYS-Better 01-02-HelloESYS-Better.c
<br>$ ./01-02-HelloESYS-Better
</table>

<p >という形で実行するようにしてください．

<p >-oは習っているはずです．実行ファイル名を"a.out"以外で作ってもらうためのオプションです．

<p >-Wallはどうですか？
<br><font size="-1" color="gray">（わからないときはgoogle様に尋ねる？しかし意外に簡単には適切なページは見つからないと思います．）</font>
<br><font size="-1" color="gray">（「壁って何？」と私も初めて見たときに思いました．）</font>
<br><font size="-1" color="gray">（まあ当時はgoogle先生はおろかWWWすらなかったのですが‥）</font>
<br>Unixのコマンドは基本的にman ページに説明があります．
<br>ターミナルウィンドウで man gccなどとします．
<table border=1><tr>
<td>$ gcc man
</table>
    <font size="-1" color="gray">（特にOSに近いコマンドの場合は説明が豊富です．）</font>
<br><font size="-1" color="gray">（manページとどこかに落ちているwwwページとの違いは、前者が原則として「製作者ないしそれに近い人が書いたドキュメント」であることです．他のはそれを他人が読んで書き直したものにすぎません．例えば、manには最後のほうにAUTHORというセクションがあります．）</font>
<br><a href="chapter01-gcc-j.html">manの説明を読む</a>と、-Wallは"Warning all"の略とわかります．
<br>つまり、文法的に許容できるけど厳密にはおかしい、というところを逐一指摘してくれます．
<br><font size="-1" color="gray">（微妙に不適切な日本語の表現までひとつひとつ指摘してくれる国語の先生のようなものですね．）</font>
<br>皆さんは、-Wallをつけても一切Warningが出てこない素晴らしい（文法的に非の打ちどころない）プログラムを書く習慣をつけてください．
<br><font size="-1" color="gray">（結局それがプログラムソースを長持ちさせるコツです．経験から断言できます．）</font>
<br><font size="-1" color="gray">（日本語でも、今風な言い回しで話をして、それを書き留めたり録音しておくと、１０年とか２０年経ってから再生すると「意味不明」と言われることでしょう．）</font>
<br><font size="-1" color="gray">（丁寧に書いた日本語なら、何年経って聞く人たちのスラングが変わっていても、間違いなく意味が通じます．）</font>
<br><font size="-1" color="gray">（例：「ヤバくね？」→２０年前なら否定の意味．今なら逆の意味．「素晴らしいですよね」と書いておけば昔も今も同じ意味です．）</font>
<br><font size="-1" color="gray">（（なんか話が脱線してるような‥））</font>

<p ><b>「printf()」を例に関数再考</b>

<p >このプログラムではprintf()というC言語が標準的に用意してくれている関数を使っています．
<br>printf()のように、自分が定義していない関数を使う場合には、必ずそれを作った人が指定している作法に従う必要があります．
<br>printf()のようなプログラミングライブラリの関数についてはmanの3章に説明が集められています．
<br><a href="chapter01-printf-j.html">printf()の作法をman ページで見てみましょう</a>．
<br><font size="-1" color="gray">（ライブラリが何かについては4.2節で振り返り学習します）</font>

<p >man ページを読むと、printf()の利用を開始する前に"#include &lt;stdio.h&gt;"を書いておきなさいと指示があることがわかります．
<br>それゆえに、皆さんは"#include &lt;stdio.h&gt;"をファイルの先頭に書かなくてはいけないのです．
<br><font size="-1" color="gray">（printf()を使わないのなら、"#include &lt;stdio.h&gt;"を書く必要はなくなります．）</font>

<p ><u><b>演習</b></u>

<p ><b>01-02-ex1</b>: printf()関数を使うときには、stdio.hが必要になります．
<br>・貴方が実際に使うことになるstdio.hのパス名（場所）を示しなさい．
<br>・そのパスが正しいという根拠を説明しなさい．
<br>・printf()を例に、stdio.hがその中で何を指定しているか説明しなさい．
<br>・stdio.hが展開されるのはコンパイル時ですか、リンク時ですか．

<p ><b>01-02-ex2</b>: float変数kに-15.2という数値が入っているとして、printf()関数を使って <b>-15.20%</b>と表示したいとします．
<br>・変数fを引数に採ってprintf()の書式をどう書くべきか示しなさい．
<br>・<a href="chapter01-printf-j.html">printf()のman ページ</a>のどの部分にその書式が載っているか該当部を示しなさい．
<br>　（該当する部分を抜き出して，簡単な日本語訳をつけなさい．１か所とは限りません）
<!-- ".2f%%" -->

<p ><b>01-02-ex3</b>: float変数kに-15.2という数値が入っているとして、printf()関数を使って12文字分の場所を使って右詰めで <b>-15.20%</b>と表示したいとします．また，kに-2.336と入っていたら，printf()関数を使って12文字分の場所を使って右詰めで <b>-2.34%</b>と表示したいとします．
<br>・変数fを引数に採ってこれらを両立できるprintf()の書式を示しなさい．
<br>・<a href="chapter01-printf-j.html">printf()のman ページ</a>のどの部分にその書式が載っているか該当部を示しなさい．
<br>　（該当する部分を抜き出して，簡単な日本語訳をつけなさい．１か所とは限りません）
<!-- "%11.2f%%" -->

<!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
<a name="sec.01.03."></a><hr width="30%" align="left">
<font color="#802020"><h3>01.03 至極丁寧なHello ESYS</h3></font>

<p >少し発展レベルになりますが，より丁寧に記述するなら，下記のように書いておくのがよいでしょう．

<p ><a href="code/01-03/01-03-HelloESYS-Full.c">01-03-HelloESYS-Full.c</a>
<br><a href="code/01-03/01-02_01-03.html">01-02からの差分</a>

<p >C言語のような関数型言語では，原則として全ての関数は返値を有します．
<br>多くの場合，返値は重要な意味を持っています．
<br>特にその関数が予定通りの作業を実施できたかどうかの目安になる値が返されることが多いです．

<p >唯一の例外はvoid型の関数です．この場合は型無しの返値となります（＝返値なし）．
<br>将来，自分で関数を定義することになったら，void型関数は，失敗のしようがない処理や，値を返してもしょうがない状況の時のみ使うように．

<p >printf()は返値をもつ関数です．どの関数であれ，返値を持つ関数の返値には<b>意味があります</b>．無視しない．
<br><font size="-1" color="gray">（<a href="chapter01-printf-j.html">printf()のman ページ</a>のReturn valueというところを参照すること．）</font>
<br><font size="-1" color="gray">（どういう値が返ってくるのか承知していて，あえて無視するのなら構いませんが‥）</font>

<p >ところで，演算順位は知っていても理解が難しいときがあります．不安な時は括弧を有効活用しましょう．

<p ><u><b>演習</b></u>

<!-- ex1:2013, ex2:2013 ex3:2014 -->

<p ><b>01-03-ex1</b>: printf()の返値についてです．
<br>・返値の内容を説明しなさい．
<br>・printf()が正常に機能しなかったことを知るにはどのようなプログラムを書けばいいか説明しなさい．
<br>・なぜprintf()の返値を使うＣ言語プログラムの例がほとんどこの世の中にない(Google先生に聞いても滅多に出てこない）のか，自分なりに説明を試みなさい．

<p ><b>01-03-ex2</b>: C言語の演算子の中で，同じ１つの記号で表されるのに２つの意味を持つものがあります．
<br>・その記号とは何ですか．
<br>・２つの演算の意味をそれぞれ説明しなさい．
<!-- & ... 単項(アドレス）・二項(バイナリAND）, * ... 単項(間接参照）・二項(積）, 一つの「記号」だから &* -->
<!-- ++/-- などの前置・後置は順序が異なるという意味では２つの意味ががあるが，記号二つ使うので本問の解ではない -->

<p ><b>01-03-ex3</b>: C言語の演算子の中で，同じ記号を２回繰り返すものがあります．
<br>・そのような演算子を知る限り上げなさい．
<br>・繰り返さない場合と，繰り返す場合のそれぞれの演算の意味を説明しなさい．
<!-- ++ -- << >> == && || と + - < > = & | -->

<!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
<a name="sec.01.04."></a><hr width="30%" align="left">
<font color="#802020"><h3>01.04 使うと便利なマクロ</h3></font>

    <p >マクロとは，C言語ファイルの中で現れる，先頭が#で始まる行のことです．
      <br>マクロは，C言語ファイルのコンパイルに先立って解釈が行われます．

    <p >C言語のソースファイルから実行ファイルを生成するまでの過程はいくつかに分かれています．
      <br>1. 元のC言語ファイル (foo.c ... C言語）
      <br>2. プリプロセッサ（下準備）によるC言語ファイル書き換え (foo.i ... C言語）
      <br>3. 下拵えの済んだC言語ファイルをアセンブリ言語に翻訳 (foo.s ... アセンブリ言語）
      <br>4. プログラム部分を機械語に書き換え (foo.o ... オブジェクトファイル）
      <br>5. 実行ファイル (オブジェクトファイル(場合によっては複数）に実行に必要なライブラリ群を組み合わせたもの）

    <p >C言語において，#defineで始まる行はプリプロセッサ命令でマクロと解釈され，上記の1.から2.のところで展開されます．
      <br>「#define N 8」というマクロが定義されれば，以降では全て N は　8 に置き換えられます．
      <br>マクロは自分で定義して使ってもちろんOKですが，Cコンパイラの仕様で元から定義されている便利なマクロもあります．

    <p ><a href="code/01-04/01-04-HelloESYS-Macros.c">01-04-HelloESYS-Macros.c</a>

    <p >$gcc -save-temps 01-04-HelloESYS-Macros.c


<!-- ex1:2013, ex2:2013,2014 ex3:2014 -->

<p ><u><b>演習</b></u>

<p ><b>01-04-ex1</b>: Ｃ言語では，数学上便利な様々な数値がマクロとして定義されています．
<br>・それはどこで発見できるはずですか？
<br>・実際に５つ以上の数学マクロについて，出典をファイル名・行単位で示しながらその定義を明かにしなさい．

<p ><b>01-04-ex2</b>: 本演習ではgccを用いてＣ言語プログラムのコンパイルを行います．
<br>・使用するgccのバージョンを示しなさい．バージョンを知る方法についても説明すること．
<br><font size="-1" color="gray">（ヒント：gccにはバージョンを教えてくれる機能があります．）</font>
<br>・そのgccのバージョンが理解するＣ言語の仕様を示しなさい．
<br><font size="-1" color="gray">（日本語にも標準語，関西弁，茨城弁があるように，Ｃ言語にも様々な違いがあります．人間と違ってコンピュータの世界は融通が利かないので，gccが解釈できるＣ言語の「方言」の文法は厳密に決まっています．）</font>
<br><font size="-1" color="gray">（コンパイル作業に入る前に，どの方言で理解してもらうかgccに指定すべきです．実は今まで皆さんは暗黙のうちに指定してきていました）</font>
<!-- gcc 4.5 and later substantially supports C99 -->

<p ><b>01-04-ex3</b>: 現在，Ｃ言語の最新版はどうなっていますか．
<br>・最新のＣ言語の仕様が規定された参考文献(URL可）を示し，その特徴を簡単に述べなさい．参考文献は「公式」であることが望まれます．誰がその言語仕様を策定したかも調べてみること．
<!-- 一例として http://www.iso-9899.info/wiki/The_Standard -->

<p ><b>01-04-ex4</b>: <a href="chapter01-gcc-j.html">gccのman ページ</a>を参照して，このmanページに載っているgccが理解する「方言」がどれぐらいあるか調べなさい．
<br>・そのうちの２つを選んで簡単な説明を加えなさい．
<!-- 荒いレベルでは OPtions / C Languagge Options -->
<!-- 一番細かいレベルの記述は Options Controlling C Dialect -->
<!-- c89 c99 c9x gnu89 gnu9x c++98(=ansi) gnu++98 c++0x gnu++x ただし ++ はいらないので最初５つで十分 -->
<!-- gcc版 なら https://www.gnu.org/software/gnu-c-manual/gnu-c-manual.html#Preface -->

<hr><!-- +++++++++++++++++++++++++++++++++++ -->
kameda[at]ccs.tsukuba.ac.jp
</body>
</html>
